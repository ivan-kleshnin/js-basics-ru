# Проверка типов

Тип значения в JS определяется с помощью оператора `typeof`:

```js
typeof 2          // "number"    |
typeof "hi"       // "string"    | информативно
typeof undefined  // "undefined" |
typeof []         // "object"  |
typeof {}         // "object"  | не информативно
typeof new Date() // "object"  |
typeof /^jack/    // "object"  |
```

Из этих правил есть досадные исключения. Первым исключением является `null`,
который, вследствие технической [ошибки](http://www.2ality.com/2013/10/typeof-null.html), имеет неверный `typeof`:

```js
typeof null // "object"
```

Вторым исключением (в этот раз – удобным) является `function`.
Функция – объект, однако обнаруживается и в пространстве типов:

```js
typeof function () {} // "function", а не "object"
```

Как определить тип объекта?

В большинстве источников, вам предложат использовать оператор `instanceof`
или приведение объекта к строке с помощью "хитрых трюков":

```js
new Date() instanceof Date // true
/^foo/ instanceof RegExp   // true

class Duck { ... }
new Duck instanceof Duck   // true

if (typeof Object.prototype.toString.call() == "function") {
  // wtf
}
```

Все эти подходы обладают рядом недостатков и будут рассмотрены
в разделе **Прототипная модель**.

Правильным подходом к данной проблеме является **Утиная Типизация**.

Её идея состоит в следующем. Для объектов, следует выстраивать логику
на базе **интерфейса** (т.е набора свойств), а не типа или прототипа.

Так, проверка `instanceof Array` перед `for-of` циклом исключает поддержку итераторов.
Проверка `instanceof Promise` исключает поддержку т.н. `then-able` объектов.
Чтобы поддерживать расширяемость кода, всегда отдавайте предпочтение утиной типизации.

Например:

```js
// Вместо
if (user instanceof User) {
  // ...
}

// лучше
if ("name" in user) {
  // ...
}

// или
if (user.name) {
  // ...
}
```

или

```js
// Вместо проверки прототипа
if (xs instanceof Array) {
  for (x of xs) {
    // ...
  }
}

// лучше (непосредственно)
for (x of xs) {
  // ...
}

// или (с проверкой на интерфейс Итератора)
if (typeof xs.next == "function") {
  for (x of xs) {
    // ...
  }
}
```
